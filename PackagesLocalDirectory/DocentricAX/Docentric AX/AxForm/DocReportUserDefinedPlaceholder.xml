<?xml version="1.0" encoding="utf-8"?>
<AxForm xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="Microsoft.Dynamics.AX.Metadata.V6">
	<Name>DocReportUserDefinedPlaceholder</Name>
	<SourceCode>
		<Methods xmlns="">
			<Method>
				<Name>classDeclaration</Name>
				<Source><![CDATA[
using DOCRX = Docentric.AX.Reporting.XPath;

[Form]
public class DocReportUserDefinedPlaceholder extends FormRun implements IDocRefreshable, OfficeIMenuCustomizer
{
    FormRun callerFormRun;
    DOCRX.XPathDdspHelper xPathDdspHelper;
    Map standardCustomPlaceholdersMap;      // placeholder attribute map to distinguish standard from custom placeholders

    [FormObservable]
    int defaultColor;

    #Task

}
]]></Source>
			</Method>
			<Method>
				<Name>init</Name>
				<Source><![CDATA[
    public void init()
    {
        super();

        callerFormRun = (this.args() ? this.args().caller() : null);

        NavigationListContainer.visible(true);
        PreviewFormatLanguageId.text(DocGlobalHelper::getUserFormatLanguageId());

        Expression_result.colorScheme(FormColorScheme::RGB);
        defaultColor = Expression_result.foregroundColor();

        Warning.colorScheme(FormColorScheme::RGB);
        Warning.backgroundColor(0xFFF4CE);          // yellow color from infolog warning

        // If there is no valid licence, user will be warned, but we will still let him
        // set up User-defined placeholders. Later in the pipeline we will throw the exception
        // if User-defined placeholders are used, but the license is invalid.
        DocLicenseMng::checkLicenseUI(DocConstant::FeatureUserDefPlaceholders, this.name());
    }

]]></Source>
			</Method>
			<Method>
				<Name>validateLanguage</Name>
				<Source><![CDATA[
    public boolean validateLanguage(LanguageId _lang)
    {
        container  languages = xGlobal::languageList();
        int        size = conLen(languages);

        for(int i = 1;  i <= size; i++)
        {
            if(conPeek(conPeek(languages, i), 1) == _lang)
            {
                return true;
            }
        }

        return false;
    }

]]></Source>
			</Method>
			<Method>
				<Name>refreshCallerDataSourceAndPosition</Name>
				<Source><![CDATA[
    /// <summary>
    /// Refreshes the form data and retains the current record position.
    /// </summary>
    /// <param name = "_record">Desired record to display</param>
    public void refreshCallerDataSourceAndPosition(Common _record = null)
    {
        if (_record != null)
        {
            if (_record is DocReportUserDefinedPlaceholder)
            {
                DocReportUserDefinedPlaceholder record = _record;
                DocReportUserDefinedPlaceholder.DdspDataSection = record.DdspDataSection;
                DocReportUserDefinedPlaceholder.Expression = record.Expression;

                if (DocReportUserDefinedPlaceholder.orig().DdspDataSection != DocReportUserDefinedPlaceholder.DdspDataSection ||
                    DocReportUserDefinedPlaceholder.orig().Expression != DocReportUserDefinedPlaceholder.Expression)
                {
                    element.viewEditModeHelper().setViewEditMode(ViewEditMode::Edit);
                }
            }
            else if (_record is DocReportTable)
            {
                xPathDdspHelper = element.getXPathDdspHelper();
                DocReportUserDefinedPlaceholder_ds.research(true);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>getXPathDdspHelper</Name>
				<Source><![CDATA[
    /// <summary>
    /// Gets the instance of the XPathDdspHelper object.
    /// </summary>
    /// <returns>An instance of the XPathDdspHelper object</returns>
    private DOCRX.XPathDdspHelper getXPathDdspHelper()
    {
        DocReportDDSP reportDDSP = DocReportDDSP::find(DocReportTable.RecId);
        xPathDdspHelper = null;
            
        if (reportDDSP.RecId)
        {
            try
            {
                DocentricEngine docentricEngine = new DocentricEngine();
                docentricEngine.renderingSettings().parmRenderingLanguageId(PreviewFormatLanguageId.valueStr());
                xPathDdspHelper = new DOCRX.XPathDdspHelper(reportDDSP.Data, PreviewFormatLanguageId.valueStr(), docentricEngine);
            }
            catch
            {
                DocGlobalHelper::handleClrError('', strFmt("@DocentricAX3:InvalidSampleDDSPFile", reportDDSP.Filename));
            }
        }

        return xPathDdspHelper;
    }

]]></Source>
			</Method>
			<Method>
				<Name>customizeMenuOptions</Name>
				<Source><![CDATA[
    /*** METHODS TO GET STANDARD (UNFILTERED) DATA ENTITY FOR OPEN IN EXCEL EVENTHOUGH OUR MAIN DATASOURCE IS NOT ROOT DATASOURCE ***/
    public void customizeMenuOptions(OfficeMenuOptions _menuOptions)
    {
        List entityOptions = _menuOptions.dataEntityOptions();

        entityOptions.addEnd(OfficeMenuDataEntityOptions::construct(tablestr(DocReportUserDefinedPlaceholderEntity)));
    }

]]></Source>
			</Method>
		</Methods>
		<DataSources xmlns="">
			<DataSource>
				<Name>DocReportTable</Name>
				<Methods>
					<Method>
						<Name>active</Name>
						<Source><![CDATA[
        public int active()
        {
            int ret = super();

            xPathDdspHelper = element.getXPathDdspHelper();

            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>executeQuery</Name>
						<Source><![CDATA[
        public void executeQuery()
        {
            super();

            ViewInGrid.enabled(DocReportTable.RecId != 0);
            ButtonOpenExcelTemplate.enabled(DocReportTable.RecId != 0);
        }

]]></Source>
					</Method>
				</Methods>
				<Fields />
			</DataSource>
			<DataSource>
				<Name>DocReportUserDefinedPlaceholder</Name>
				<Methods>
					<Method>
						<Name>resultEx</Name>
						<Source><![CDATA[
        /// <summary>
        /// Evaluates the expression string and returns the result container [error, resultStr].
        /// </summary>
        /// <param name = "_rec">A DocReportUserDefinedPlaceholder record</param>
        /// <returns>Container in the form [success, result]</returns>
        container resultEx(DocReportUserDefinedPlaceholder _rec)
        {
            if (!_rec.Expression)
            {
                return [true, ''];
            }
            
            if (!xPathDdspHelper)
            {
                return [false, "@DocentricAX3:MissingOrInvalidDDSP"];
            }
            
            DocPlaceholderExpressionResult result;
            boolean success;
            str     errMsg;

            [success, result, errMsg] = _rec.evaluate(xPathDdspHelper);

            if (!success)
            {
                result = strFmt("@DocentricAX3:InvalidPlaceholderExpression", errMsg);
            }

            return [success, result];
        }

]]></Source>
					</Method>
					<Method>
						<Name>result</Name>
						<Source><![CDATA[
        [SysClientCacheDataMethodAttribute(true)]
        display DocPlaceholderExpressionResult result(DocReportUserDefinedPlaceholder _rec)
        {
            boolean success;
            str     resultStr;

            [success, resultStr] = this.resultEx(_rec);

            return resultStr;
        }

]]></Source>
					</Method>
					<Method>
						<Name>resultWithColor</Name>
						<Source><![CDATA[
        [SysClientCacheDataMethodAttribute(true)]
        display DocPlaceholderExpressionResult resultWithColor(DocReportUserDefinedPlaceholder _rec)
        {
            boolean success;
            str     resultStr;

            [success, resultStr] = this.resultEx(_rec);

            // color red in case of error
            if ((!success) && DocReportUserDefinedPlaceholder.Expression)
            {
                Expression_result.foregroundColor(0xFF0000);    // red RGB(255,0,0)
            } 
            else
            {
                Expression_result.foregroundColor(defaultColor);
            }

            return resultStr;
        }

]]></Source>
					</Method>
					<Method>
						<Name>linkActive</Name>
						<Source><![CDATA[
        public void linkActive()
        {
            // fill placeholder attribute map
            DocReportTable report = (element.args() && element.args().dataset() == tableNum(DocReportTable) ? element.args().record() : null);
            DocPlaceholderAttHtmlEditorHelper attHelper = new DocPlaceholderAttHtmlEditorHelper();
            attHelper.collectAttributes(report.ReportId);
            standardCustomPlaceholdersMap = attHelper.getPlaceholderMap();

            super();
        }

]]></Source>
					</Method>
					<Method>
						<Name>executeQuery</Name>
						<Source><![CDATA[
        public void executeQuery()
        {
            super();

            if (!DocReportUserDefinedPlaceholder.RecId)
            {
                this.active();
            }
            else if (callerFormRun && callerFormRun.name() == formStr(DocReportPlaceholderList))
            {
                // set focus on selected placeholder from parent DocReportPlaceholderList form
                DocReportPlaceholderTmp placeholderTmp = callerFormRun.dataSource(tableStr(DocReportPlaceholderTmp)).cursor();

                if (placeholderTmp.ReportId == DocReportTable.ReportId)
                {
                    this.positionToRecordByValue(fieldNum(DocReportUserDefinedPlaceholder, PlaceholderName), placeholderTmp.PlaceholderName);
                }
            }
        }

]]></Source>
					</Method>
					<Method>
						<Name>active</Name>
						<Source><![CDATA[
        public int active()
        {
            int ret;
        
            ret = super();
        
            DocReportUserDefinedPlaceholder.setConditionalMandatoryFields();
            Expression_result.update();     // update result color

            // check conflicts with existing standard/custom placeholders
            DocGlobalHelper::assert(standardCustomPlaceholdersMap != null);

            if (standardCustomPlaceholdersMap.exists(DocReportUserDefinedPlaceholder.PlaceholderName))
            {
                DocPlaceholderAttribute placeholderAttr = standardCustomPlaceholdersMap.lookup(DocReportUserDefinedPlaceholder.PlaceholderName);
                Warning.text(strFmt("@DocentricAX3:PlaceholderAlreadyExists", (placeholderAttr.isStandardPlaceholder() ? "@DocentricAX3:Standard" : "@DocentricAX3:Custom")));
                Warning.helpText("@DocentricAX3:PlaceholderAlreadyExistsHelp");
                Warning.visible(true);
            }
            else
            {
                Warning.visible(false);
            }

            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>updateResult</Name>
						<Source><![CDATA[
        public void updateResult()
        {
            DocReportUserDefinedPlaceholder_ds.refresh();
            Expression_result.update();
        }

]]></Source>
					</Method>
				</Methods>
				<Fields />
			</DataSource>
		</DataSources>
		<DataControls xmlns="">
			<Control>
				<Name>ViewInGrid</Name>
				<Type>Button</Type>
				<Methods>
					<Method>
						<Name>clicked</Name>
						<Source><![CDATA[
        public void clicked()
        {
            super();

            element.task(#taskSwitchToGridView);
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>ButtonOpenExcelTemplate</Name>
				<Type>Button</Type>
				<Methods>
					<Method>
						<Name>clicked</Name>
						<Source><![CDATA[
        public void clicked()
        {
            // Variables used for opening Excel template
            DocuTemplateName templateName = resourceStr(DocReportUserDefinedPlaceholderEntityTemplate);
            DocuTemplate template = DocuTemplate::findTemplate(OfficeAppApplicationType::Excel, templateName);

            // Ensure the template is present
            if (!template.RecId)
            {
                new DocReportUserDefinedPlaceholderTemplateRegistration().registerTemplates();
                template = DocuTemplate::findTemplate(OfficeAppApplicationType::Excel, templateName);
            }

            DocGlobalHelper::assert(template && template.TemplateID == templateName);

            Map filtersToApply = new Map(Types::String, Types::Class);

            // Filer by ReportId
            ExportToExcelFilterTreeBuilder filterBuilder = new ExportToExcelFilterTreeBuilder(tableStr(DocReportUserDefinedPlaceholderEntity));

            var filter = filterBuilder.areEqual(fieldStr(DocReportUserDefinedPlaceholderEntity, ReportId), DocReportTable.ReportId);

            filtersToApply.insert(tableStr(DocReportUserDefinedPlaceholderEntity), filter);

            // Generate the workbook using the template and filters
            DocuTemplateRender renderer = new DocuTemplateRender();
            str documentUrl = renderer.renderTemplateToStorage(template, filtersToApply, OfficeTrimmable::construct());

            // Pass the workbook to the user
            if (documentUrl)
            {
                Browser b = new Browser();
                b.navigate(documentUrl, false, false);
            }
            else
            {
                error(strFmt("@ApplicationFoundation:DocuTemplateGenerationFailed", templateName));
            }
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>DocReportUserDefinedPlaceholderExpressionDesigner</Name>
				<Type>MenuFunctionButton</Type>
				<Methods>
					<Method>
						<Name>clicked</Name>
						<Source><![CDATA[
        /// <summary>
        /// Calls the expression designer.
        /// </summary>
        public void clicked()
        {
            // Expression designer can be opened if a record exists
            if (!DocReportUserDefinedPlaceholder.Report)
            {
                throw error("@DocentricAX3:PlaceholderExpressionDesignerMissingRecord");
            }

            // Expression designer can be opened if valid DDSP file exists
            if (xPathDdspHelper == null)
            {
                throw error("@DocentricAX3:PlaceholderExpressionDesignerMissingOrInvalidDDSP");
            }

            super();
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>DetailsPanel</Name>
				<Type>TabPage</Type>
				<Methods>
					<Method>
						<Name>pageActivated</Name>
						<Source><![CDATA[
        public void pageActivated()
        {
            super();

            ViewInGrid.visible(true);
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>PreviewFormatLanguageId</Name>
				<Type>String</Type>
				<Methods>
					<Method>
						<Name>validate</Name>
						<Source><![CDATA[
        public boolean validate()
        {
            boolean    ret;
        
            ret = super();
        
            if(ret)
            {
                if(this.text() != '')
                {
                    // Region selection currently uses the same list of values as the Language selection
                    ret = element.validateLanguage(this.text());
        
                    if(!ret)
                    {
                        warning("@ApplicationFoundation:SysUserSetup_InvalidRegion");
                    }
                }
            }
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>modified</Name>
						<Source><![CDATA[
        public boolean modified()
        {
            boolean ret;
        
            ret = super();

            // Change the format langauge of XPathDdspHelper
            xPathDdspHelper = element.getXPathDdspHelper();
            DocReportUserDefinedPlaceholder_ds.updateResult();
        
            return ret;
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>GridPanel</Name>
				<Type>TabPage</Type>
				<Methods>
					<Method>
						<Name>pageActivated</Name>
						<Source><![CDATA[
        public void pageActivated()
        {
            super();

            ViewInGrid.visible(false);
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
		</DataControls>
		<Members xmlns="" />
	</SourceCode>
	<DataSources>
		<AxFormDataSource xmlns="">
			<Name>DocReportTable</Name>
			<Table>DocReportTable</Table>
			<Fields>
				<AxFormDataSourceField>
					<DataField>ArchivingEmailAttachmentsOption</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ArchivingReportParamsOption</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ArchivingReportsOption</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CreatedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CreatedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DataSourceProviderClassName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailAccountDisplayName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailBounceToAddress</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailDeliveryReceiptCondition</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailEmailingMode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailMsgPriority</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailReadReceiptAddress</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EmailReplyToAddress</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ERModelDataToIncludeInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ERModelMapping</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>GenerateXmlDsWithReportRun</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>GenerateXmlDsWithReportRunSettings</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeAllDisplayMethodsInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeCompanyLogoInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeDocuBrandingInDSSRS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeHiddenParamsInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeReportDefinedDispMethodsInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeReportDefinedFieldsInDS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IncludeSystemFieldsInDSSRS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsActiveSRS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsValid</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LastValidationDatetime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ModifiedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ModifiedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Partition</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PdfDocumentAuthor</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PdfDocumentKeywords</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PdfDocumentSubject</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PdfDocumentTitle</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ReportDefaultCaption</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ReportDescription</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ReportGroup</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ReportId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ReportUsageType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SRSOnlyReportName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SRSReportDesignName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SRSReportName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SuppressRDPExecution</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TableId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>UseDocentricPreviewerForSrs</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>UseDocentricPreviewForSrs</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>UseOnlyWithPrintDestinations</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ValidationErrorList</DataField>
				</AxFormDataSourceField>
			</Fields>
			<ReferencedDataSources />
			<AllowCreate>No</AllowCreate>
			<AllowDelete>No</AllowDelete>
			<AllowEdit>No</AllowEdit>
			<InsertAtEnd>No</InsertAtEnd>
			<InsertIfEmpty>No</InsertIfEmpty>
			<DataSourceLinks />
			<DerivedDataSources />
		</AxFormDataSource>
		<AxFormDataSource xmlns="">
			<Name>DocReportUserDefinedPlaceholder</Name>
			<Table>DocReportUserDefinedPlaceholder</Table>
			<Fields>
				<AxFormDataSourceField>
					<DataField>CreatedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CreatedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DdspDataSection</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Enabled</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Expression</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FormatString</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ModifiedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ModifiedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Partition</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PlaceholderDesc</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PlaceholderName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Report</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TableId</DataField>
				</AxFormDataSourceField>
			</Fields>
			<ReferencedDataSources />
			<JoinSource>DocReportTable</JoinSource>
			<Index>ReportPlaceholderNameIdx</Index>
			<InsertAtEnd>No</InsertAtEnd>
			<InsertIfEmpty>No</InsertIfEmpty>
			<DataSourceLinks />
			<DerivedDataSources />
		</AxFormDataSource>
	</DataSources>
	<Design>
		<Caption xmlns="">@DocentricAX3:UserDefinedPlaceholders</Caption>
		<DataSource xmlns="">DocReportUserDefinedPlaceholder</DataSource>
		<DefaultAction xmlns="">MainGridDefaultAction</DefaultAction>
		<Pattern xmlns="">DetailsMaster</Pattern>
		<PatternVersion xmlns="">1.4</PatternVersion>
		<SetCompany xmlns="">No</SetCompany>
		<Style xmlns="">DetailsFormMaster</Style>
		<TitleDataSource xmlns="">DocReportUserDefinedPlaceholder</TitleDataSource>
		<Controls xmlns="">
			<AxFormControl xmlns=""
				i:type="AxFormActionPaneControl">
				<Name>ActionPane</Name>
				<ElementPosition>715827882</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<HeightMode>Auto</HeightMode>
				<Type>ActionPane</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<Width>0</Width>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormButtonGroupControl">
						<Name>ButtonGroup</Name>
						<ElementPosition>1342177278</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Left>0</Left>
						<Type>ButtonGroup</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormButtonControl">
								<Name>ViewInGrid</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<Type>Button</Type>
								<FormControlExtension
									i:nil="true" />
								<MultiSelect>Yes</MultiSelect>
								<NormalImage>ViewAll</NormalImage>
								<Text>@DocentricAX3:ViewInGrid</Text>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormButtonControl">
								<Name>ButtonOpenExcelTemplate</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<Type>Button</Type>
								<FormControlExtension
									i:nil="true" />
								<MultiSelect>Yes</MultiSelect>
								<Text>@GeneralLedger:OpenInExcel</Text>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormMenuFunctionButtonControl">
								<Name>DocReportPlaceholderList</Name>
								<HelpText>@DocentricAX2:PlaceholderListHelp</HelpText>
								<Type>MenuFunctionButton</Type>
								<FormControlExtension
									i:nil="true" />
								<DataSource>DocReportTable</DataSource>
								<MenuItemName>DocReportPlaceholderList</MenuItemName>
								<MultiSelect>Yes</MultiSelect>
								<NeedsRecord>Yes</NeedsRecord>
								<SaveRecord>No</SaveRecord>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormMenuFunctionButtonControl">
								<Name>SampleDDSP</Name>
								<ElementPosition>1879048189</ElementPosition>
								<FilterExpression>%1</FilterExpression>
								<HeightMode>Auto</HeightMode>
								<HelpText>@DocentricAX3:SampleDDSPHelp</HelpText>
								<Type>MenuFunctionButton</Type>
								<VerticalSpacing>-1</VerticalSpacing>
								<WidthMode>Auto</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<ButtonDisplay>TextOnly</ButtonDisplay>
								<DataSource>DocReportTable</DataSource>
								<MenuItemName>DocReportDDSP</MenuItemName>
								<NeedsRecord>Yes</NeedsRecord>
								<Text>Sample DDSP</Text>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormMenuFunctionButtonControl">
								<Name>DocReportUserDefinedPlaceholderExpressionDesigner</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<HelpText>@DocentricAX3:PlaceholderWxpressionDesignerHelp</HelpText>
								<Type>MenuFunctionButton</Type>
								<FormControlExtension
									i:nil="true" />
								<DataSource>DocReportUserDefinedPlaceholder</DataSource>
								<MenuItemName>DocReportUserDefinedPlaceholderExpressionDesigner</MenuItemName>
								<MultiSelect>No</MultiSelect>
								<SaveRecord>No</SaveRecord>
							</AxFormControl>
						</Controls>
					</AxFormControl>
				</Controls>
				<AlignChild>No</AlignChild>
				<AlignChildren>No</AlignChildren>
				<ArrangeMethod>Vertical</ArrangeMethod>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGroupControl">
				<Name>NavigationListContainer</Name>
				<AutoDeclaration>Yes</AutoDeclaration>
				<ElementPosition>429496729</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<HeightMode>SizeToAvailable</HeightMode>
				<Type>Group</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<Visible>No</Visible>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl>
						<Name>NavigationListQuickFilterControl</Name>
						<WidthMode>SizeToAvailable</WidthMode>
						<FormControlExtension>
							<Name>QuickFilterControl</Name>
							<ExtensionComponents />
							<ExtensionProperties>
								<AxFormControlExtensionProperty>
									<Name>targetControlName</Name>
									<Type>String</Type>
									<Value>Grid</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>defaultColumnName</Name>
									<Type>String</Type>
									<Value>DocReportUserDefinedPlaceholder_PlaceholderName</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>placeholderText</Name>
									<Type>String</Type>
								</AxFormControlExtensionProperty>
							</ExtensionProperties>
						</FormControlExtension>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormGridControl">
						<Name>ListGrid</Name>
						<AllowEdit>No</AllowEdit>
						<ElementPosition>715827882</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<Type>Grid</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>SizeToContent</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>ListGrid_PlaceholderName</Name>
								<HeightMode>Auto</HeightMode>
								<Type>String</Type>
								<WidthMode>Auto</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<DataField>PlaceholderName</DataField>
								<DataSource>DocReportUserDefinedPlaceholder</DataSource>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>ListGrid_PlaceholderDesc</Name>
								<HeightMode>Auto</HeightMode>
								<Type>String</Type>
								<WidthMode>Auto</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<DataField>PlaceholderDesc</DataField>
								<DataSource>DocReportUserDefinedPlaceholder</DataSource>
							</AxFormControl>
						</Controls>
						<AlternateRowShading>No</AlternateRowShading>
						<DataSource>DocReportUserDefinedPlaceholder</DataSource>
						<GridLinesStyle>Vertical</GridLinesStyle>
						<MultiSelect>No</MultiSelect>
						<ShowRowLabels>No</ShowRowLabels>
						<Style>List</Style>
					</AxFormControl>
				</Controls>
				<RightMargin>0</RightMargin>
				<RightMarginMode>Fixed</RightMarginMode>
				<FrameType>None</FrameType>
				<Style>SidePanel</Style>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormTabControl">
				<Name>Tab</Name>
				<AutoDeclaration>Yes</AutoDeclaration>
				<Type>Tab</Type>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormTabPageControl">
						<Name>DetailsPanel</Name>
						<AutoDeclaration>Yes</AutoDeclaration>
						<Type>TabPage</Type>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormGroupControl">
								<Name>TitleGroup</Name>
								<Type>Group</Type>
								<Visible>No</Visible>
								<WidthMode>SizeToAvailable</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<Controls>
									<AxFormControl xmlns=""
										i:type="AxFormStringControl">
										<Name>Title</Name>
										<Skip>Yes</Skip>
										<Type>String</Type>
										<WidthMode>SizeToAvailable</WidthMode>
										<FormControlExtension
											i:nil="true" />
										<DataMethod>titleFields</DataMethod>
										<DataSource>DocReportUserDefinedPlaceholder</DataSource>
										<ShowLabel>No</ShowLabel>
										<Style>TitleField</Style>
									</AxFormControl>
								</Controls>
								<ArrangeMethod>HorizontalLeft</ArrangeMethod>
								<FrameType>None</FrameType>
								<Style>DetailTitleContainer</Style>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormTabControl">
								<Name>DetailsTab</Name>
								<AlignControl>No</AlignControl>
								<ElementPosition>1073741822</ElementPosition>
								<FilterExpression>%1</FilterExpression>
								<Type>Tab</Type>
								<VerticalSpacing>-1</VerticalSpacing>
								<FormControlExtension
									i:nil="true" />
								<Controls>
									<AxFormControl xmlns=""
										i:type="AxFormTabPageControl">
										<Name>General</Name>
										<Pattern>Custom</Pattern>
										<Type>TabPage</Type>
										<FormControlExtension
											i:nil="true" />
										<Controls>
											<AxFormControl xmlns=""
												i:type="AxFormGroupControl">
												<Name>PlaceholderGroup</Name>
												<ElementPosition>536870911</ElementPosition>
												<FilterExpression>%1</FilterExpression>
												<Type>Group</Type>
												<VerticalSpacing>-1</VerticalSpacing>
												<FormControlExtension
													i:nil="true" />
												<Controls>
													<AxFormControl xmlns=""
														i:type="AxFormStringControl">
														<Name>PlaceholderGroup_PlaceholderName</Name>
														<Type>String</Type>
														<FormControlExtension
															i:nil="true" />
														<DataField>PlaceholderName</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
													</AxFormControl>
													<AxFormControl xmlns=""
														i:type="AxFormStringControl">
														<Name>PlaceholderGroup_PlaceholderDesc</Name>
														<Type>String</Type>
														<FormControlExtension
															i:nil="true" />
														<DataField>PlaceholderDesc</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
													</AxFormControl>
													<AxFormControl xmlns=""
														i:type="AxFormCheckBoxControl">
														<Name>PlaceholderGroup_Enabled</Name>
														<Type>CheckBox</Type>
														<FormControlExtension
															i:nil="true" />
														<DataField>Enabled</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
													</AxFormControl>
												</Controls>
												<ArrangeMethod>HorizontalLeft</ArrangeMethod>
												<DataGroup>Placeholder</DataGroup>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
												<FrameType>None</FrameType>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>Warning</Name>
												<AllowEdit>No</AllowEdit>
												<AutoDeclaration>Yes</AutoDeclaration>
												<Type>String</Type>
												<WidthMode>SizeToAvailable</WidthMode>
												<FormControlExtension
													i:nil="true" />
												<Label>@SYS866</Label>
											</AxFormControl>
										</Controls>
										<ArrangeMethod>HorizontalLeft</ArrangeMethod>
										<Caption>@SYS19924</Caption>
										<FastTabExpanded>Yes</FastTabExpanded>
									</AxFormControl>
									<AxFormControl xmlns=""
										i:type="AxFormTabPageControl">
										<Name>ExpressionTabPage</Name>
										<ElementPosition>1610612734</ElementPosition>
										<FilterExpression>%1</FilterExpression>
										<HeightMode>Auto</HeightMode>
										<Pattern>Custom</Pattern>
										<Type>TabPage</Type>
										<VerticalSpacing>-1</VerticalSpacing>
										<WidthMode>SizeToAvailable</WidthMode>
										<FormControlExtension
											i:nil="true" />
										<Controls>
											<AxFormControl xmlns=""
												i:type="AxFormGroupControl">
												<Name>Expression</Name>
												<Type>Group</Type>
												<WidthMode>SizeToAvailable</WidthMode>
												<FormControlExtension
													i:nil="true" />
												<Controls>
													<AxFormControl xmlns=""
														i:type="AxFormComboBoxControl">
														<Name>Expression_DdspDataSection</Name>
														<Type>ComboBox</Type>
														<FormControlExtension
															i:nil="true" />
														<DataField>DdspDataSection</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
														<Items />
													</AxFormControl>
													<AxFormControl xmlns=""
														i:type="AxFormStringControl">
														<Name>Expression_Expression</Name>
														<Type>String</Type>
														<WidthMode>SizeToAvailable</WidthMode>
														<FormControlExtension
															i:nil="true" />
														<DataField>Expression</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
													</AxFormControl>
													<AxFormControl xmlns=""
														i:type="AxFormStringControl">
														<Name>Expression_FormatString</Name>
														<Type>String</Type>
														<FormControlExtension
															i:nil="true" />
														<DataField>FormatString</DataField>
														<DataSource>DocReportUserDefinedPlaceholder</DataSource>
													</AxFormControl>
												</Controls>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
												<FrameType>None</FrameType>
											</AxFormControl>
										</Controls>
										<Caption>@DocentricAX3:PlaceholderExpressionLong</Caption>
										<FastTabExpanded>Yes</FastTabExpanded>
										<Scrollbars>Auto</Scrollbars>
									</AxFormControl>
									<AxFormControl xmlns=""
										i:type="AxFormTabPageControl">
										<Name>Preview</Name>
										<Pattern>Custom</Pattern>
										<Type>TabPage</Type>
										<FormControlExtension
											i:nil="true" />
										<Controls>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>Expression_result</Name>
												<AutoDeclaration>Yes</AutoDeclaration>
												<HelpText>@DocentricAX3:PlaceholderExpressionResultSampleDDSP</HelpText>
												<Type>String</Type>
												<WidthMode>SizeToAvailable</WidthMode>
												<FormControlExtension
													i:nil="true" />
												<DataMethod>resultWithColor</DataMethod>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>PreviewFormatLanguageId</Name>
												<AutoDeclaration>Yes</AutoDeclaration>
												<HelpText>@DocentricAX3:PreviewFormatLanguageHelp</HelpText>
												<Type>String</Type>
												<FormControlExtension
													i:nil="true" />
												<DisplayLength>10</DisplayLength>
												<DisplayLengthMode>Fixed</DisplayLengthMode>
												<ExtendedDataType>LanguageId</ExtendedDataType>
												<Label>@SYS:SysUserSetup_Locale</Label>
											</AxFormControl>
										</Controls>
										<Caption>@SYS54744</Caption>
										<FastTabExpanded>Yes</FastTabExpanded>
									</AxFormControl>
									<AxFormControl xmlns=""
										i:type="AxFormTabPageControl">
										<Name>Instructions</Name>
										<Pattern>FillText</Pattern>
										<PatternVersion>UX7 1.0</PatternVersion>
										<Type>TabPage</Type>
										<WidthMode>SizeToAvailable</WidthMode>
										<FormControlExtension
											i:nil="true" />
										<Controls>
											<AxFormControl xmlns=""
												i:type="AxFormStaticTextControl">
												<Name>InstructionsText</Name>
												<HeightMode>SizeToAvailable</HeightMode>
												<Type>StaticText</Type>
												<WidthMode>SizeToAvailable</WidthMode>
												<FormControlExtension
													i:nil="true" />
												<Text>@DocentricAX3:UserDefinedPlaceholdersInstructionsText</Text>
											</AxFormControl>
										</Controls>
										<Caption>@DocentricAX2:ReportAttachmentRuleInstructions</Caption>
										<FastTabExpanded>Yes</FastTabExpanded>
									</AxFormControl>
								</Controls>
								<AlignChild>No</AlignChild>
								<ArrangeMethod>Vertical</ArrangeMethod>
								<Style>FastTabs</Style>
							</AxFormControl>
						</Controls>
						<PanelStyle>Details</PanelStyle>
						<Style>DetailsFormDetails</Style>
					</AxFormControl>
					<AxFormControl xmlns=""
						i:type="AxFormTabPageControl">
						<Name>GridPanel</Name>
						<AutoDeclaration>Yes</AutoDeclaration>
						<Type>TabPage</Type>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormGroupControl">
								<Name>CustomFilterGroup</Name>
								<Pattern>CustomAndQuickFilters</Pattern>
								<PatternVersion>1.1</PatternVersion>
								<Type>Group</Type>
								<WidthMode>SizeToAvailable</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<Controls>
									<AxFormControl>
										<Name>QuickFilterControl</Name>
										<FormControlExtension>
											<Name>QuickFilterControl</Name>
											<ExtensionComponents />
											<ExtensionProperties>
												<AxFormControlExtensionProperty>
													<Name>targetControlName</Name>
													<Type>String</Type>
													<Value>Grid</Value>
												</AxFormControlExtensionProperty>
												<AxFormControlExtensionProperty>
													<Name>placeholderText</Name>
													<Type>String</Type>
												</AxFormControlExtensionProperty>
												<AxFormControlExtensionProperty>
													<Name>defaultColumnName</Name>
													<Type>String</Type>
													<Value>GridGroup_PlaceholderName</Value>
												</AxFormControlExtensionProperty>
											</ExtensionProperties>
										</FormControlExtension>
									</AxFormControl>
								</Controls>
								<ArrangeMethod>HorizontalLeft</ArrangeMethod>
								<FrameType>None</FrameType>
								<Style>CustomFilter</Style>
								<ViewEditMode>Edit</ViewEditMode>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormGridControl">
								<Name>Grid</Name>
								<Type>Grid</Type>
								<FormControlExtension
									i:nil="true" />
								<Controls>
									<AxFormControl xmlns=""
										i:type="AxFormGroupControl">
										<Name>GridGroup</Name>
										<Type>Group</Type>
										<FormControlExtension
											i:nil="true" />
										<Controls>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>GridGroup_PlaceholderName</Name>
												<Type>String</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>PlaceholderName</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>GridGroup_PlaceholderDesc</Name>
												<Type>String</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>PlaceholderDesc</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormCheckBoxControl">
												<Name>GridGroup_Enabled</Name>
												<Type>CheckBox</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>Enabled</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormComboBoxControl">
												<Name>GridGroup_DdspDataSection</Name>
												<Type>ComboBox</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>DdspDataSection</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
												<Items />
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>GridGroup_Expression</Name>
												<Type>String</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>Expression</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
												<DisplayHeight>1</DisplayHeight>
												<DisplayHeightMode>Fixed</DisplayHeightMode>
												<MultiLine>Yes</MultiLine>
											</AxFormControl>
											<AxFormControl xmlns=""
												i:type="AxFormStringControl">
												<Name>GridGroup_FormatString</Name>
												<Type>String</Type>
												<FormControlExtension
													i:nil="true" />
												<DataField>FormatString</DataField>
												<DataSource>DocReportUserDefinedPlaceholder</DataSource>
											</AxFormControl>
										</Controls>
										<DataGroup>Grid</DataGroup>
										<DataSource>DocReportUserDefinedPlaceholder</DataSource>
									</AxFormControl>
									<AxFormControl xmlns=""
										i:type="AxFormStringControl">
										<Name>Grid_result</Name>
										<HelpText>@DocentricAX3:PlaceholderExpressionResultSampleDDSP</HelpText>
										<Type>String</Type>
										<WidthMode>SizeToAvailable</WidthMode>
										<FormControlExtension
											i:nil="true" />
										<DataMethod>result</DataMethod>
										<DataSource>DocReportUserDefinedPlaceholder</DataSource>
										<DisplayHeight>1</DisplayHeight>
										<DisplayHeightMode>Fixed</DisplayHeightMode>
										<MultiLine>Yes</MultiLine>
									</AxFormControl>
								</Controls>
								<DataSource>DocReportUserDefinedPlaceholder</DataSource>
								<DefaultAction>MainGridDefaultAction</DefaultAction>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormCommandButtonControl">
								<Name>MainGridDefaultAction</Name>
								<Type>CommandButton</Type>
								<Visible>No</Visible>
								<FormControlExtension
									i:nil="true" />
								<Command>DetailsView</Command>
							</AxFormControl>
						</Controls>
						<PanelStyle>Grid</PanelStyle>
						<Style>DetailsFormGrid</Style>
					</AxFormControl>
				</Controls>
				<ArrangeMethod>Vertical</ArrangeMethod>
				<ShowTabs>No</ShowTabs>
			</AxFormControl>
		</Controls>
	</Design>
	<Parts />
</AxForm>