<?xml version="1.0" encoding="utf-8"?>
<AxForm xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="Microsoft.Dynamics.AX.Metadata.V6">
	<Name>DocReportGlobalAttachment</Name>
	<SourceCode>
		<Methods xmlns="">
			<Method>
				<Name>classDeclaration</Name>
				<Source><![CDATA[
[Form]
public class DocReportGlobalAttachment extends FormRun
{
    private FormCommandButtonControl attachmentButton;
    private boolean hasUserRightsForLegalEntity;

    DataAreaId  initialCompany = curExt();  
    
    [FormObservable]
    TableId companyInfoBaseTableId = DocuRef::GetRootTableID(tableNum(CompanyInfo));
    
}
]]></Source>
			</Method>
			<Method>
				<Name>init</Name>
				<Source><![CDATA[
    /// <summary>
    /// Initializes the form.
    /// </summary>
    public void init()
    {
        #SysSystemDefinedButtons

        // Position the cursor at the current company (similar as on Legal entities form)
        CompanyInfo legalEntity = CompanyInfo::findDataArea(curExt());
        element.args().lookupRecord(legalEntity);

        super();

        // Hide Attach button if user has no privilege to view current legal entity
        
        // Get hold of the Attachment (document management) button,
        // we will show or hide it dynamically
        attachmentButton = this.control(this.controlId(#SystemDefinedAttachButton)) as FormCommandButtonControl;
    }

]]></Source>
			</Method>
			<Method>
				<Name>hasUserAccessRightForCurrentLegalEntity</Name>
				<Source><![CDATA[
    /// <summary>
    /// Gets the flag indicating whether the current user has access rights for the current legal entity.
    /// </summary>
    /// <returns>True if the current user has access rights; otherwise false</returns>
    public boolean hasUserAccessRightForCurrentLegalEntity()
    {
        SecurityRights securityRights = SecurityRights::construct();
        AccessRight right = securityRights.menuItemAccessRight(SecurableType::MenuItemDisplay, menuItemDisplayStr(OMLegalEntities));

        return right != AccessRight::NoAccess;
    }

]]></Source>
			</Method>
			<Method>
				<Name>switchToLegalEntity</Name>
				<Source><![CDATA[
    /// <summary>
    /// Switches execution to the specified legal entity.
    /// </summary>
    /// <param name = "_selectableDataArea">The legal entity to switch to.</param>
    /// <returns>A boolean value indicating whether the switch was successful.</returns>
    public void switchToLegalEntity(SelectableDataArea _selectableDataArea)
    {
        if (!xDataArea::exist(_selectableDataArea))
        {
            return;
        }

        appl.setDefaultCompany(_selectableDataArea, false);
    }

]]></Source>
			</Method>
			<Method>
				<Name>close</Name>
				<Source><![CDATA[
    /// <summary>
    /// Called when the form is closed.
    /// </summary>
    public void close()
    {
        super();
        
        element.switchToLegalEntity(initialCompany);
    }

]]></Source>
			</Method>
		</Methods>
		<DataSources xmlns="">
			<DataSource>
				<Name>CompanyInfo</Name>
				<Methods>
					<Method>
						<Name>getTotalsAllAttachments</Name>
						<Source><![CDATA[
        /// <summary>
        /// A display method for the number of all attachments for the specified company.
        /// </summary>
        /// <param name = "_companyInfo">The CompanyInfo record</param>
        /// <returns>A number of all attachments for the given company</returns>
        display PositiveNumber getTotalsAllAttachments(CompanyInfo _companyInfo)
        {
            DocuRef docuRef;

            select count(RecId) from docuRef where
                docuRef.RefCompanyId == _companyInfo.dataAreaId &&  // DocuView use this filters and records with invalid RefCompanyId have also been seen in database
                docuRef.RefTableId == companyInfoBaseTableId &&
                docuRef.RefRecId == _companyInfo.RecId;
            
            return int642int(docuRef.RecId);
        }

]]></Source>
					</Method>
					<Method>
						<Name>getTotals</Name>
						<Source><![CDATA[
        /// <summary>
        /// A display method for the number of all global attachments for the specified company.
        /// </summary>
        /// <param name = "_companyInfo">The CompanyInfo record</param>
        /// <returns>A number of all global attachments for the given company</returns>
        display PositiveNumber getTotals(CompanyInfo _companyInfo)
        {
            DocuRef     docuRef;

            select count(RecId) from docuRef
                where docuRef.RefCompanyId == _companyInfo.dataAreaId
                    && docuRef.RefTableId == companyInfoBaseTableId
                    && docuRef.RefRecId == _companyInfo.RecId
                    && docuRef.IsGlobalAttachment_DC == NoYes::Yes;

            return int642int(docuRef.RecId);
        }

]]></Source>
					</Method>
					<Method>
						<Name>getTotalsPerLanguage</Name>
						<Source><![CDATA[
        /// <summary>
        /// A display method for the number of global attachments per language for the specified company.
        /// </summary>
        /// <param name = "_companyInfo">The CompanyInfo record</param>
        /// <returns>A list of a number of global attachmnets per language for the given company</returns>
        display str getTotalsPerLanguage(CompanyInfo _companyInfo)
        {
            str retVal = '';            
            DocuRef docuRef;

            while select LanguageId_DC, count(RecId) from docuRef
                group by docuRef.LanguageId_DC
                order by docuRef.LanguageId_DC
                where docuRef.LanguageId_DC != ''
                    && docuRef.RefCompanyId == _companyInfo.dataAreaId                
                    && docuRef.RefTableId == companyInfoBaseTableId
                    && docuRef.RefRecId == _companyInfo.RecId
                    && docuRef.IsGlobalAttachment_DC == NoYes::Yes
            {
                retVal += (retVal == '' ? '' : '; \n') + strFmt('%1 (%2)', docuRef.LanguageId_DC, docuRef.RecId);
            }                              
                
            return retVal;
        }

]]></Source>
					</Method>
					<Method>
						<Name>getTotalsPerCategory</Name>
						<Source><![CDATA[
        /// <summary>
        /// A display method for the number of global attachments per category for the specified company.
        /// </summary>
        /// <param name = "_companyInfo">The CompanyInfo record</param>
        /// <returns>A list of a number of global attachmnets per category for the given company</returns>
        display str getTotalsPerCategory(CompanyInfo _companyInfo)
        {
            str retVal = '';
            DocuRef docuRef;

            while select count(RecId) from docuRef
                group by docuRef.CategoryId_DC
                order by docuRef.CategoryId_DC
                    where docuRef.CategoryId_DC != '' 
                        && docuRef.RefCompanyId == _companyInfo.dataAreaId
                        && docuRef.RefTableId == companyInfoBaseTableId
                        && docuRef.RefRecId == _companyInfo.RecId
                        && docuRef.IsGlobalAttachment_DC == NoYes::Yes
            {
                retVal += (retVal == '' ? '' : '; \n') + strFmt('%1 (%2)', docuRef.CategoryId_DC, docuRef.RecId);
            }
            
            return retVal;
        }

]]></Source>
					</Method>
					<Method>
						<Name>active</Name>
						<Source><![CDATA[
        /// <summary>
        /// Called when a record becomes active.
        /// </summary>
        /// <returns>A current record position</returns>
        public int active()
        {
            int ret;
        
            element.switchToLegalEntity(CompanyInfo.DataArea);

            ret = super();

            // Show/hide Attachment (document management) button 
            hasUserRightsForLegalEntity = element.hasUserAccessRightForCurrentLegalEntity();
            if (attachmentButton)
            {
                attachmentButton.visible(hasUserRightsForLegalEntity);
            }
        
            return ret;
        }

]]></Source>
					</Method>
				</Methods>
				<Fields />
			</DataSource>
		</DataSources>
		<DataControls xmlns="">
			<Control>
				<Name>DocuView</Name>
				<Type>MenuFunctionButton</Type>
				<Methods>
					<Method>
						<Name>clicked</Name>
						<Source><![CDATA[
        /// <summary>
        /// Called when the DocuView menu button is clicked.
        /// </summary>
        public void clicked()
        {
            if (!hasUserRightsForLegalEntity)
            {
                DocGlobalHelper::handleException(funcName(), strFmt("@DocentricAX2:UserHasNoPrivilegeForLegalEntity", curUserId(), CompanyInfo.DataArea));
            }

            #Task
            // Open attachments using task() instead of menu item to ensure the same security behavior
            element.task(#taskAttachments);
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>CompanyInfo_getTotalsAllAttachments</Name>
				<Type>Integer</Type>
				<Methods>
					<Method>
						<Name>jumpRef</Name>
						<Source><![CDATA[
        /// <summary>
        /// Jumps to the referenced form.
        /// </summary>
        public void jumpRef()
        {
            DocuView.clicked();
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>CompanyInfo_getTotalsGlobalAttachments</Name>
				<Type>Integer</Type>
				<Methods>
					<Method>
						<Name>jumpRef</Name>
						<Source><![CDATA[
        /// <summary>
        /// Jumps to the referenced form.
        /// </summary>
        public void jumpRef()
        {
            DocReportGlobalAttachmentDetail.clicked();
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
		</DataControls>
		<Members xmlns="" />
	</SourceCode>
	<DataSources>
		<AxFormDataSource xmlns="">
			<Name>CompanyInfo</Name>
			<Table>CompanyInfo</Table>
			<Fields>
				<AxFormDataSourceField>
					<DataField>Accountant_LT</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>AccountingPersonnel_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>AccountOfficeRefNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ActivityCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>AddrFormat</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Bank</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BankAcctUsedFor1099</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BankCentralBankPurposeCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BankCentralBankPurposeText</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BranchId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessActivityDesc_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessActivity_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessCommencedDate_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessInitialCapital_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessItem_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>BusinessNumber_CA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CertifiedTaxAccountant_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CNAE_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CombinedFedStateFiler</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CompanyInitialCapital_FR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CompanyNAFCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CompanyRegComFR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CompanyRepresentative_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CompanyType_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ConversionDate</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CoRegNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>CUC_IT</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Curp_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DashboardImageType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DataArea</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DBA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DeclarantName_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AccountingBookType_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AccountingOrigin_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Address</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AddressBuilding_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AddressComplement_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AddressNumber_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_AssessingOfficerNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Building_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CCMNum_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CellularPhone</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CircleNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_City</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CNPJCPFNum_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CodeOKDP_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CodeOKPO_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Commissionarate_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CompanyIdNAF</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CountryRegionId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_County</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_CurrencyCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_dataAreaId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_DDOCode_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_DDORegNum_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Dimension_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Director_EE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_DirOrgBase_Shadow_DataAreaId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_DistrictName_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Division_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ECCNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Email</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_EnableNorway</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_EntityType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_EstablishmentType_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Estate_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_EuroCurrencyCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ExciseType_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_FallbackInventLocationId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_FallbackInventLocationId1_41</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Features_W</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_FirstName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_FirstNameKana_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_FiscalCalendar</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Flat_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_GBTIndustry_CN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_GBTOrgNum_CN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_GBTOrgType_CN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_GenerationalSuffix</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_IECNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_IENum_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_IMNSCode_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_IMNSName_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_INN_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_INN__RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_InstanceRelationTypeName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_KPPU_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_LanguageId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_LastName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_LastNameKana_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Memo</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_MiddleName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_MinistryCode_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_MinistryName_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_MinistryType_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ModifiedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ModifiedDate</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ModifiedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ModTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ModTime_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Name</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_NameSequence</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_OGRN_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_OKATO_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_OrganizationNum_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Pager</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PAOCode_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PAORegNum_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PartyId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PaymInstructionId1</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PaymInstructionId2</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PaymInstructionId3</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PaymInstructionId4</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PermanentAccountNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PermanentAccountStatus_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PersonNameKana_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PersonNameOrder</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Phone</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PhoneLocal</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_PhoneticName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Prefix</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ProfessionalSuffix</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Range_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_RelationTypeName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_RelationTypeName_DirOrganizationBase</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_RelationTypeName_OMInternalOrg</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_REntryDate</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_SalesTaxRegistrationNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Salutation</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_SecondaryCurrencyCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_SettlementId_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Shadow_DataAreaId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_SMS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_State</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_StateCode_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_STCNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Street</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_StreetId_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TAN_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TeleFax</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Telex</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TIN_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TownId_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TradeName_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TributarySubstitutionRegistry_BR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_Type</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_TypeOfDeductor_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_URL</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_UseHolidayCalendar_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_UseSeveralAddressFormatTypes_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_WardNumber_IN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DEL_ZipCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DunsNumberRecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DVRid</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EeEnablePersonalDataReadLog</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EeEnableRoleChangeLog</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>EnterpriseCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FICreditorID_DK</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FileNumber_SA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FiscalCode_IT</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ForeignEntityIndicator</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FSSAccount_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>FSS_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Giro</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>GiroContract</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>GiroContractAccount</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Head_LT</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ImportVATNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ImportVATNumBranchId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>InstanceRelationType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IntrastatCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsConsolidationCompany</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsEliminationCompany</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IssuingSignature</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Key</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>KnownAs</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LanguageId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LastFilingIndicator</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalFormFR</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalNature_IT</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalRepresentativeCurp_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalRepresentativeName_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalRepresentativeRfc_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LegalRepresentative_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>LocalizationCountryRegionCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>NAICS</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Name</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>NameAlias</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>NameControl</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>OrganizationLegalForm_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>OrganizationType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>OrgId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PackMaterialFeeLicenseNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Partition</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PartyNumber</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymInstruction1</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymInstruction2</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymInstruction3</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymInstruction4</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymRoutingDNB</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PaymTraderNumber</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PersonInCharge_JP</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PFRegNum_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PhoneticName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PlanningCompany</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryAddressLocation</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactEmail</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactFacebook</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactFax</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactLinkedIn</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactPhone</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactTelex</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactTwitter</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrimaryContactURL</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrintCorrInvoiceLabelEffDate_DE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrintCorrInvoiceLabel_DE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrintEnterpriseregister_NO</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PrintINNKPPInAddress_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ProfitMarginScheme_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RAlienCorpCountry</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RAlienCorpName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RegNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Resident_W</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Rfc_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RFullName</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ShippingCalendarId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SiaCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SoftwareIdentificationCode_CA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>StateInscription_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>SubordinateCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TableId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Tax1099RegNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxableAgencyName_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxableAgentName_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxablePersonName_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxAuthority_RU</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxGSTHSTAccountId_CA</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxRegimeCode_MX</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TaxRepresentative</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TCC</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TemplateFolder_W</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>UPSNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>validate1099OnEntry</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>VATNum</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>VATNumBranchId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>VATOnCustomerBehalf_AE</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>VATRefund_AE</DataField>
				</AxFormDataSourceField>
			</Fields>
			<ReferencedDataSources />
			<AllowCreate>No</AllowCreate>
			<AllowDelete>No</AllowDelete>
			<InsertAtEnd>No</InsertAtEnd>
			<InsertIfEmpty>No</InsertIfEmpty>
			<DataSourceLinks />
			<DerivedDataSources />
		</AxFormDataSource>
	</DataSources>
	<Design>
		<Caption xmlns="">@DocentricAX2:GlobalAttachments</Caption>
		<DataSource xmlns="">CompanyInfo</DataSource>
		<DefaultAction xmlns="">ViewGlobalAttachments</DefaultAction>
		<Pattern xmlns="">SimpleList</Pattern>
		<PatternVersion xmlns="">1.1</PatternVersion>
		<SetCompany xmlns="">No</SetCompany>
		<ShowDeleteButton xmlns="">No</ShowDeleteButton>
		<ShowNewButton xmlns="">No</ShowNewButton>
		<Style xmlns="">SimpleList</Style>
		<ViewEditMode xmlns="">View</ViewEditMode>
		<Controls xmlns="">
			<AxFormControl xmlns=""
				i:type="AxFormActionPaneControl">
				<Name>AppBar</Name>
				<Type>ActionPane</Type>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormButtonGroupControl">
						<Name>ButtonGroup</Name>
						<AutoDeclaration>Yes</AutoDeclaration>
						<ElementPosition>1610612733</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Left>0</Left>
						<Type>ButtonGroup</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormMenuFunctionButtonControl">
								<Name>DocuView</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<HelpText>@DocentricAX2:AllAttachmentsHelp</HelpText>
								<Type>MenuFunctionButton</Type>
								<FormControlExtension
									i:nil="true" />
								<ButtonDisplay>TextWithImageLeft</ButtonDisplay>
								<MenuItemName>DocuView</MenuItemName>
								<MultiSelect>No</MultiSelect>
								<NeedsRecord>Yes</NeedsRecord>
								<NormalImage>Attach</NormalImage>
								<Text>@DocentricAX2:AllAttachments</Text>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormMenuFunctionButtonControl">
								<Name>DocReportGlobalAttachmentDetail</Name>
								<AutoDeclaration>Yes</AutoDeclaration>
								<ElementPosition>715827880</ElementPosition>
								<FilterExpression>%1</FilterExpression>
								<HeightMode>Auto</HeightMode>
								<HelpText>@DocentricAX2:DocentricAttachmentsHelp</HelpText>
								<Type>MenuFunctionButton</Type>
								<VerticalSpacing>-1</VerticalSpacing>
								<WidthMode>Auto</WidthMode>
								<FormControlExtension
									i:nil="true" />
								<DataSource>CompanyInfo</DataSource>
								<MenuItemName>DocReportGlobalAttachmentDetail</MenuItemName>
								<MultiSelect>No</MultiSelect>
								<NeedsRecord>Yes</NeedsRecord>
								<NormalImage>View</NormalImage>
							</AxFormControl>
						</Controls>
					</AxFormControl>
				</Controls>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGroupControl">
				<Name>CustomFilterGroup</Name>
				<Pattern>CustomAndQuickFilters</Pattern>
				<PatternVersion>1.1</PatternVersion>
				<Type>Group</Type>
				<WidthMode>SizeToAvailable</WidthMode>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl>
						<Name>QuickFilter</Name>
						<FormControlExtension>
							<Name>QuickFilterControl</Name>
							<ExtensionComponents />
							<ExtensionProperties>
								<AxFormControlExtensionProperty>
									<Name>targetControlName</Name>
									<Type>String</Type>
									<Value>Grid</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>defaultColumnName</Name>
									<Type>String</Type>
									<Value>Overview_GroupId</Value>
								</AxFormControlExtensionProperty>
								<AxFormControlExtensionProperty>
									<Name>placeholderText</Name>
									<Type>String</Type>
								</AxFormControlExtensionProperty>
							</ExtensionProperties>
						</FormControlExtension>
					</AxFormControl>
				</Controls>
				<ArrangeMethod>HorizontalLeft</ArrangeMethod>
				<FrameType>None</FrameType>
				<Style>CustomFilter</Style>
				<ViewEditMode>Edit</ViewEditMode>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGridControl">
				<Name>Grid</Name>
				<AllowEdit>No</AllowEdit>
				<Type>Grid</Type>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormGroupControl">
						<Name>Overview</Name>
						<Type>Group</Type>
						<FormControlExtension
							i:nil="true" />
						<Controls>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>CompanyInfo_Name</Name>
								<Type>String</Type>
								<FormControlExtension
									i:nil="true" />
								<DataField>Name</DataField>
								<DataSource>CompanyInfo</DataSource>
								<Label>@DocentricAX2:LegalEntity</Label>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>CompanyInfo_DataArea</Name>
								<Type>String</Type>
								<FormControlExtension
									i:nil="true" />
								<DataField>DataArea</DataField>
								<DataSource>CompanyInfo</DataSource>
								<Label>@SYS66152</Label>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormIntegerControl">
								<Name>CompanyInfo_getTotalsAllAttachments</Name>
								<HelpText>@DocentricAX2:NumberOfAllAttachmentsHelp</HelpText>
								<Type>Integer</Type>
								<FormControlExtension
									i:nil="true" />
								<CacheDataMethod>Yes</CacheDataMethod>
								<DataMethod>getTotalsAllAttachments</DataMethod>
								<DataSource>CompanyInfo</DataSource>
								<Label>@DocentricAX2:NumberOfAllAttachments</Label>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormIntegerControl">
								<Name>CompanyInfo_getTotalsGlobalAttachments</Name>
								<HelpText>@DocentricAX2:NumberTotalHelp</HelpText>
								<Type>Integer</Type>
								<FormControlExtension
									i:nil="true" />
								<CacheDataMethod>Yes</CacheDataMethod>
								<DataMethod>getTotals</DataMethod>
								<DataSource>CompanyInfo</DataSource>
								<Label>@DocentricAX2:NumberTotal</Label>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>CompanyInfo_getTotalsPerLanguage</Name>
								<HelpText>@DocentricAX2:NumberPerLanguageHelp</HelpText>
								<Type>String</Type>
								<FormControlExtension
									i:nil="true" />
								<Alignment>Right</Alignment>
								<CacheDataMethod>Yes</CacheDataMethod>
								<DataMethod>getTotalsPerLanguage</DataMethod>
								<DataSource>CompanyInfo</DataSource>
								<Label>@DocentricAX2:NumberPerLanguage</Label>
							</AxFormControl>
							<AxFormControl xmlns=""
								i:type="AxFormStringControl">
								<Name>CompanyInfo_getTotalsPerCategory</Name>
								<HelpText>@DocentricAX2:NumberPerCategoryHelp</HelpText>
								<Type>String</Type>
								<FormControlExtension
									i:nil="true" />
								<Alignment>Right</Alignment>
								<CacheDataMethod>Yes</CacheDataMethod>
								<DataMethod>getTotalsPerCategory</DataMethod>
								<DataSource>CompanyInfo</DataSource>
								<Label>@DocentricAX2:NumberPerCategory</Label>
							</AxFormControl>
						</Controls>
						<DataSource>CompanyInfo</DataSource>
					</AxFormControl>
				</Controls>
				<DataSource>CompanyInfo</DataSource>
				<Style>Tabular</Style>
			</AxFormControl>
		</Controls>
	</Design>
	<Parts />
</AxForm>